# ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ã‚¸ã‚§ãƒãƒ¬ãƒ¼ã‚¿ãƒ¼é–‹ç™º å¼•ãç¶™ããƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

## ğŸ“‹ ã‚»ãƒƒã‚·ãƒ§ãƒ³æ¦‚è¦

### å®Ÿæ–½ã—ãŸåˆ†æå†…å®¹

1. **AI Chat V3 â†’ ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ã‚¸ã‚§ãƒãƒ¬ãƒ¼ã‚¿ãƒ¼è»¢ç”¨å¯èƒ½æ€§åˆ†æ**
   - æ—¢å­˜ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®90ãƒ•ã‚¡ã‚¤ãƒ«ä»¥ä¸Šã‚’åˆ†æ
   - è»¢ç”¨å¯èƒ½ãª20æ©Ÿèƒ½ã‚’æœ‰åŠ¹åº¦é †ã«ãƒªã‚¹ãƒˆåŒ–
   - æœ€é«˜è»¢ç”¨å¯èƒ½æ©Ÿèƒ½: ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ç®¡ç†(100%), ãƒˆãƒ©ãƒƒã‚«ãƒ¼(95%), ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆæ§‹ç¯‰(90%)

2. **å‚ç…§ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ æ©Ÿèƒ½èª¿æŸ»**
   - ãƒ•ã‚¡ã‚¤ãƒ«: `.claude/é¸æŠ.md` ã‚’è©³ç´°åˆ†æ
   - 8ã¤ã®ä¸»è¦é¸æŠè¦ç´ ã‚’ç‰¹å®šï¼ˆã‚¸ãƒ£ãƒ³ãƒ«ã€ã‚¯ã‚¨ã‚¹ãƒˆã€è¦–ç‚¹ã€æ–¹å‘æ€§ç­‰ï¼‰
   - 50ç¨®é¡ä»¥ä¸Šã®ã‚¸ãƒ£ãƒ³ãƒ«è¨­å®šã‚·ã‚¹ãƒ†ãƒ ã‚’ç¢ºèª

3. **UI/UXè¨­è¨ˆå®Œäº†**
   - 4æ®µéšåŸ·ç­†ãƒ•ãƒ­ãƒ¼è¨­è¨ˆï¼ˆåˆæœŸåŒ–â†’ã‚¢ã‚¦ãƒˆãƒ©ã‚¤ãƒ³â†’ç”Ÿæˆâ†’ç·¨é›†ï¼‰
   - æ—¢å­˜ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆè»¢ç”¨ãƒãƒƒãƒ—ä½œæˆï¼ˆ65%è»¢ç”¨å¯èƒ½ï¼‰
   - ãƒ¢ãƒã‚¤ãƒ«æœ€é©åŒ–å¯¾å¿œï¼ˆiPhone 15 Pro Maxï¼‰

---

## ğŸ¯ ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆç›®æ¨™

**AI Chat V3ã®è³‡ç”£ã‚’æ´»ç”¨ã—ãŸé«˜åº¦ãªã‚¹ãƒˆãƒ¼ãƒªãƒ¼ã‚¸ã‚§ãƒãƒ¬ãƒ¼ã‚¿ãƒ¼æ§‹ç¯‰**

### æ ¸å¿ƒçš„ãªé•ã„ã®ç†è§£

| é …ç›® | ãƒãƒ£ãƒƒãƒˆãƒœãƒƒãƒˆ | ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ã‚¸ã‚§ãƒãƒ¬ãƒ¼ã‚¿ãƒ¼ |
|------|--------------|---------------------|
| æ€§è³ª | ãƒªã‚¢ã‚¯ãƒ†ã‚£ãƒ–ï¼ˆåå¿œå‹ï¼‰ | ãƒ—ãƒ­ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ï¼ˆèƒ½å‹•å‹ï¼‰ |
| çŠ¶æ…‹ | ã‚¹ãƒ†ãƒ¼ãƒˆãƒ¬ã‚¹ | ã‚¹ãƒ†ãƒ¼ãƒˆãƒ•ãƒ« |
| ç›®çš„ | å¯¾è©±ã®ç¶™ç¶š | ç‰©èªã®ä¸€è²«æ€§ç¶­æŒ |
| ç”Ÿæˆå˜ä½ | å˜ä¸€ã‚¿ãƒ¼ãƒ³ | ã‚·ãƒ¼ãƒ³ã€ç« ã€ç‰©èªå…¨ä½“ |
| åˆ¶å¾¡ | å®‰å…¨ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ | æ§‹é€ çš„è¨ˆç”»+æ¤œè¨¼ãƒ«ãƒ¼ãƒ— |

---

## ğŸ“Š è»¢ç”¨å¯èƒ½æ©Ÿèƒ½ãƒˆãƒƒãƒ—10ï¼ˆæœ‰åŠ¹åº¦é †ï¼‰

### ğŸ¥‡ è¶…é«˜è»¢ç”¨å¯èƒ½ï¼ˆ85-100%ï¼‰

#### 1. ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ  [æœ‰åŠ¹åº¦: 100%]
- **ãƒ•ã‚¡ã‚¤ãƒ«**: `src/types/core/character.types.ts`, `src/store/slices/character.slice.ts`
- **è»¢ç”¨å…ˆ**: ç‰©èªã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ã‚·ãƒ¼ãƒˆç®¡ç†
- **å¿…è¦ãªæ‹¡å¼µ**:
  ```typescript
  // è¿½åŠ ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰
  interface StoryCharacter extends Character {
    current_location: string;      // ç¾åœ¨ä½ç½®
    emotional_state: string;        // æ„Ÿæƒ…çŠ¶æ…‹
    memory: MemoryEvent[];          // ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼è¨˜æ†¶
    inventory: Item[];              // æ‰€æŒå“
    relationships_graph: Map<string, Relationship>; // é–¢ä¿‚æ€§ã‚°ãƒ©ãƒ•
  }
  ```

#### 2. ãƒˆãƒ©ãƒƒã‚«ãƒ¼ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ  [æœ‰åŠ¹åº¦: 95%]
- **ãƒ•ã‚¡ã‚¤ãƒ«**: `src/services/tracker/tracker-manager.ts`
- **è»¢ç”¨å…ˆ**: ãƒ—ãƒ­ãƒƒãƒˆçŠ¶æ…‹è¿½è·¡ã€ã‚¤ãƒ™ãƒ³ãƒˆãƒ­ã‚°ï¼ˆSVOå½¢å¼ï¼‰
- **å¿…è¦ãªæ‹¡å¼µ**:
  ```typescript
  // SVOãƒˆãƒªãƒ—ãƒ¬ãƒƒãƒˆå½¢å¼å¯¾å¿œ
  interface PlotNode {
    subject: string;    // ä¸»èª
    verb: string;       // å‹•è©
    object: string;     // ç›®çš„èª
    timestamp: number;
    causedBy: string | null;  // å› æœé–¢ä¿‚
  }
  ```

#### 3. ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆæ§‹ç¯‰ã‚µãƒ¼ãƒ“ã‚¹ [æœ‰åŠ¹åº¦: 90%]
- **ãƒ•ã‚¡ã‚¤ãƒ«**: `src/services/prompt-builder.service.ts`, `src/services/memory/conversation-manager/`
- **è»¢ç”¨å…ˆ**: Plan-and-Write ãƒ‘ãƒ©ãƒ€ã‚¤ãƒ ï¼ˆã‚¢ã‚¦ãƒˆãƒ©ã‚¤ãƒ³â†’ç« åŸ·ç­†ï¼‰
- **æ—¢å­˜æ§‹é€ **:
  ```
  System â†’ Character â†’ Memory â†’ Conversation
  ```
- **æ–°è¦æ§‹é€ **:
  ```
  System â†’ Outline â†’ Act Summary â†’ Recent Scenes â†’ Character States
  ```

#### 4. è¨˜æ†¶ã‚·ã‚¹ãƒ†ãƒ  [æœ‰åŠ¹åº¦: 85%]
- **ãƒ•ã‚¡ã‚¤ãƒ«**: `src/services/memory/memory-card-generator.ts`
- **è»¢ç”¨å…ˆ**: ä¸–ç•Œè¨­å®šï¼ˆLoreï¼‰ç®¡ç†ã€ã‚¤ãƒ™ãƒ³ãƒˆè¨˜éŒ²
- **å¿…è¦ãªã‚«ãƒ†ã‚´ãƒªæ‹¡å¼µ**: `world_rule`, `historical_event`, `location_info`

#### 5. ä¼šè©±ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ  [æœ‰åŠ¹åº¦: 80%]
- **ãƒ•ã‚¡ã‚¤ãƒ«**: `src/services/memory/conversation-manager.ts`
- **è»¢ç”¨å…ˆ**: éšå±¤çš„ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆç®¡ç†
- **æ–°ã‚¯ãƒ©ã‚¹**:
  ```typescript
  class StoryContextManager extends ConversationManager {
    private fullOutline: string;       // å¸¸æ™‚å‚ç…§
    private currentActSummary: string; // ç¾åœ¨ã®å¹•
    private recentScenes: string[];    // ç›´è¿‘3ã‚·ãƒ¼ãƒ³
  }
  ```

### ğŸ¥ˆ é«˜è»¢ç”¨å¯èƒ½ï¼ˆ70-85%ï¼‰

#### 6. ãƒ™ã‚¯ãƒˆãƒ«æ¤œç´¢ [80%] - ä¸–ç•Œè¨­å®šã®ã‚»ãƒãƒ³ãƒ†ã‚£ãƒƒã‚¯æ¤œç´¢
#### 7. ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç† [75%] - ç‰©èªé€²è¡ŒçŠ¶æ…‹ã®æ°¸ç¶šåŒ–
#### 8. APIçµ±åˆåŸºç›¤ [75%] - å¤šæ®µéšç”Ÿæˆã®LLMå‘¼ã³å‡ºã—
#### 9. ã‚·ãƒŠãƒªã‚ªã‚¸ã‚§ãƒãƒ¬ãƒ¼ã‚¿ãƒ¼ [70%] - ãƒ—ãƒ­ãƒƒãƒˆæ¦‚è¦ç”Ÿæˆ
#### 10. å‹•çš„è¦ç´„ [70%] - ç« ãƒ»å¹•ã®ã‚µãƒãƒªãƒ¼è‡ªå‹•ç”Ÿæˆ

---

## ğŸ¨ UIè¨­è¨ˆæ¦‚è¦

### ç”»é¢æ§‹æˆï¼ˆ3ã‚«ãƒ©ãƒ ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆï¼‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Project  â”‚   Main Canvas       â”‚ Settings â”‚
â”‚ Sidebar  â”‚   (Writing Area)    â”‚ Panel    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Story    â”‚ Chapter/Scene       â”‚ Genre    â”‚
â”‚ List     â”‚ Display             â”‚ Quest    â”‚
â”‚          â”‚                     â”‚ POV      â”‚
â”‚ Outline  â”‚ Control Bar         â”‚ Tracker  â”‚
â”‚ - Act I  â”‚ [Generate][Edit]    â”‚          â”‚
â”‚ - Act II â”‚ [Validate][Export]  â”‚ World    â”‚
â”‚ - Act IIIâ”‚                     â”‚ State    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4æ®µéšåŸ·ç­†ãƒ•ãƒ­ãƒ¼

#### Phase 1: ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆåˆæœŸåŒ–ï¼ˆã‚¦ã‚£ã‚¶ãƒ¼ãƒ‰å½¢å¼ï¼‰
- **Step 1**: ä¸–ç•Œè¨­å®šï¼ˆã‚¸ãƒ£ãƒ³ãƒ«ã€ãƒˆãƒ¼ãƒ³ã€ä¸–ç•Œãƒ«ãƒ¼ãƒ«ï¼‰
- **Step 2**: ã‚¯ã‚¨ã‚¹ãƒˆé¸æŠï¼ˆå†’é™º/ãƒ­ãƒãƒ³ã‚¹/ãƒŸã‚¹ãƒ†ãƒªãƒ¼ç­‰ï¼‰
- **Step 3**: ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼é¸æŠï¼ˆä¸»äººå…¬/è„‡å½¹/æ•µå½¹ï¼‰
- **Step 4**: ç‰©èªæ§‹é€ é¸æŠï¼ˆä¸‰å¹•/è‹±é›„ã®æ—…/èµ·æ‰¿è»¢çµï¼‰

#### Phase 2: ã‚¢ã‚¦ãƒˆãƒ©ã‚¤ãƒ³ç”Ÿæˆ
- AIè‡ªå‹•ç”Ÿæˆ or ãƒãƒ‹ãƒ¥ã‚¢ãƒ«ç·¨é›†
- ãƒ—ãƒ­ãƒƒãƒˆãƒã‚¤ãƒ³ãƒˆé…ç½®ï¼ˆãƒ‰ãƒ©ãƒƒã‚°&ãƒ‰ãƒ­ãƒƒãƒ—ï¼‰
- ä¾å­˜é–¢ä¿‚ãƒ“ã‚¸ãƒ¥ã‚¢ãƒ©ã‚¤ã‚¼ãƒ¼ã‚·ãƒ§ãƒ³

#### Phase 3: ç« /ã‚·ãƒ¼ãƒ³ç”Ÿæˆ
- ãƒ‡ã‚£ãƒ¬ã‚¯ãƒ†ã‚£ãƒ–å…¥åŠ›ï¼ˆä¾‹: "ã‚¨ãƒ©ãƒ©ãŒç§˜å¯†ã‚’æ˜ã‹ã™"ï¼‰
- ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ä¸€è²«æ€§ãƒã‚§ãƒƒã‚¯
- ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼çŠ¶æ…‹è‡ªå‹•æ›´æ–°

#### Phase 4: ç·¨é›†ãƒ»æ”¹å–„
- å†ç”Ÿæˆã€åˆ†å²ä½œæˆ
- ä¸€è²«æ€§æ¤œè¨¼
- ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆï¼ˆTXT/DOCX/EPUBï¼‰

---

## ğŸ§© æ—¢å­˜ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆè»¢ç”¨ãƒãƒƒãƒ—

### å®Œå…¨è»¢ç”¨ï¼ˆ80%ä»¥ä¸Šï¼‰

| æ—¢å­˜ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ | è»¢ç”¨å…ˆ | å¤‰æ›´å†…å®¹ |
|------------------|--------|---------|
| `CharacterForm.tsx` | `StoryCharacterEditor` | Trackers â†’ Character States |
| `ChatSidebar.tsx` | `ProjectSidebar` | Sessions â†’ Projects |
| `MessageBubble.tsx` | `SceneBlock` | Message â†’ Scene Display |
| `TrackerDisplay.tsx` | `WorldStatePanel` | Tracker â†’ World State |
| `ScenarioSetupModal.tsx` | `StoryCreationWizard` (Step 2) | Scenario â†’ Quest Setup |

### éƒ¨åˆ†è»¢ç”¨ï¼ˆ50-80%ï¼‰

| æ—¢å­˜ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ | è»¢ç”¨å…ˆ | å¤‰æ›´å†…å®¹ |
|------------------|--------|---------|
| `MessageInput.tsx` | `DirectiveInput` | Actions â†’ Writing Commands |
| `SettingsModal.tsx` | `StorySettingsModal` | æ–°ãƒ‘ãƒãƒ«è¿½åŠ : Genre/Quest |
| `ChatHistoryModal.tsx` | `StoryVersionHistory` | History â†’ Version Management |

### æ–°è¦ä½œæˆå¿…è¦

1. `OutlineEditor` - ãƒ—ãƒ­ãƒƒãƒˆãƒã‚¤ãƒ³ãƒˆç·¨é›†UI
2. `ConsistencyValidator` - ä¸€è²«æ€§ãƒã‚§ãƒƒã‚¯çµæœè¡¨ç¤º
3. `BranchManager` - ç‰©èªåˆ†å²ç®¡ç†
4. `WorldLibrary` - å ´æ‰€ãƒ»ã‚¢ã‚¤ãƒ†ãƒ ãƒ»ãƒ«ãƒ¼ãƒ«ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒª

---

## ğŸ“ æ¨å¥¨ãƒ•ã‚¡ã‚¤ãƒ«æ§‹é€ 

```
src/
â”œâ”€â”€ story-generator/
â”‚   â”œâ”€â”€ types/
â”‚   â”‚   â”œâ”€â”€ story-core.types.ts         # æ ¸å¿ƒå‹å®šç¾©
â”‚   â”‚   â”œâ”€â”€ story-structure.types.ts    # æ§‹é€ å‹å®šç¾©
â”‚   â”‚   â”œâ”€â”€ story-generation.types.ts   # ç”Ÿæˆé–¢é€£å‹
â”‚   â”‚   â””â”€â”€ story-ui.types.ts           # UIå‹å®šç¾©
â”‚   â”‚
â”‚   â”œâ”€â”€ services/
â”‚   â”‚   â”œâ”€â”€ outline-generator.service.ts
â”‚   â”‚   â”œâ”€â”€ scene-generator.service.ts
â”‚   â”‚   â”œâ”€â”€ consistency-validator.service.ts
â”‚   â”‚   â”œâ”€â”€ world-state-manager.service.ts
â”‚   â”‚   â””â”€â”€ story-export.service.ts
â”‚   â”‚
â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”œâ”€â”€ wizard/
â”‚   â”‚   â”‚   â”œâ”€â”€ StoryCreationWizard.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ GenreSelector.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ QuestSelector.tsx
â”‚   â”‚   â”‚   â””â”€â”€ StructureSelector.tsx
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ editor/
â”‚   â”‚   â”‚   â”œâ”€â”€ OutlineEditor.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ SceneEditor.tsx
â”‚   â”‚   â”‚   â””â”€â”€ DirectiveInput.tsx
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ panels/
â”‚   â”‚   â”‚   â”œâ”€â”€ ProjectSidebar.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ ContextPanel.tsx
â”‚   â”‚   â”‚   â””â”€â”€ WorldStatePanel.tsx
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€â”€ validation/
â”‚   â”‚       â”œâ”€â”€ ConsistencyAlert.tsx
â”‚   â”‚       â””â”€â”€ ValidationReport.tsx
â”‚   â”‚
â”‚   â””â”€â”€ store/
â”‚       â”œâ”€â”€ story.slice.ts
â”‚       â”œâ”€â”€ outline.slice.ts
â”‚       â””â”€â”€ world-state.slice.ts
```

---

## ğŸ”§ é‡è¦ãªæŠ€è¡“çš„æ±ºå®šäº‹é …

### 1. çŠ¶æ…‹ç®¡ç†ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

**å•é¡Œ**: ãƒãƒ£ãƒƒãƒˆãƒœãƒƒãƒˆã®ã‚¹ãƒ†ãƒ¼ãƒˆãƒ¬ã‚¹ vs ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ã®ã‚¹ãƒ†ãƒ¼ãƒˆãƒ•ãƒ«

**è§£æ±ºç­–**:
```typescript
// æ°¸ç¶šçš„ãªä¸–ç•ŒçŠ¶æ…‹ç®¡ç†
interface WorldModel {
  characters: Map<string, StoryCharacter>;
  locations: Map<string, Location>;
  items: Map<string, Item>;
  events: PlotNode[];  // SVOãƒˆãƒªãƒ—ãƒ¬ãƒƒãƒˆå½¢å¼
  worldRules: WorldRule[];
  timestamp: number;
}

// å„ã‚·ãƒ¼ãƒ³ç”Ÿæˆæ™‚ã«ä¸–ç•ŒçŠ¶æ…‹ã‚’æ›´æ–°
class WorldStateManager {
  updateFromScene(scene: Scene): WorldModel {
    // ã‚·ãƒ¼ãƒ³ã‹ã‚‰çŠ¶æ…‹å¤‰åŒ–ã‚’æŠ½å‡º
    // ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ä½ç½®ã€æ„Ÿæƒ…ã€æ‰€æŒå“ã‚’æ›´æ–°
    // ã‚¤ãƒ™ãƒ³ãƒˆãƒ­ã‚°ã«è¿½åŠ ï¼ˆå› æœé–¢ä¿‚ä»˜ãï¼‰
  }
}
```

### 2. Plan-and-Write ãƒ‘ãƒ©ãƒ€ã‚¤ãƒ å®Ÿè£…

**ãƒ•ã‚§ãƒ¼ã‚º1**: é«˜ãƒ¬ãƒ™ãƒ«è¨ˆç”»ç”Ÿæˆ
```typescript
async generateOutline(setup: WorldSetup): Promise<StoryOutline> {
  const prompt = `
    ã‚¸ãƒ£ãƒ³ãƒ«: ${setup.genre}
    ã‚¯ã‚¨ã‚¹ãƒˆ: ${setup.quest_goal}

    ä¸‰å¹•æ§‹æˆã§ã‚¢ã‚¦ãƒˆãƒ©ã‚¤ãƒ³ã‚’ç”Ÿæˆ:
    - ç¬¬ä¸€å¹•: è¨­å®šã¨äº‹ä»¶ï¼ˆ25%ï¼‰
    - ç¬¬äºŒå¹•: è‘›è—¤ã®æ·±åŒ–ï¼ˆ50%ï¼‰
    - ç¬¬ä¸‰å¹•: è§£æ±ºï¼ˆ25%ï¼‰
  `;

  return await llm.generate(prompt);
}
```

**ãƒ•ã‚§ãƒ¼ã‚º2**: æ¡ä»¶ä»˜ãè©³ç´°ç”Ÿæˆ
```typescript
async generateChapter(
  chapterNum: number,
  outline: StoryOutline,
  worldState: WorldModel
): Promise<Chapter> {
  const prompt = `
    ## ç‰©èªå…¨ä½“ã®ã‚¢ã‚¦ãƒˆãƒ©ã‚¤ãƒ³
    ${outline}

    ## ç¾åœ¨ã¾ã§ã®é€²è¡Œ
    ${summarizePreviousChapters()}

    ## ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ç¾åœ¨çŠ¶æ…‹
    ${worldState.characters}

    ## åŸ·ç­†æŒ‡ç¤º
    ç¬¬${chapterNum}ç« ã‚’åŸ·ç­†ã€‚
    é”æˆã™ã¹ããƒ—ãƒ­ãƒƒãƒˆãƒã‚¤ãƒ³ãƒˆ: ${outline.acts[currentAct].plot_points[0]}
  `;

  return await llm.generate(prompt);
}
```

### 3. Generate-Evaluate-Refine ãƒ«ãƒ¼ãƒ—

```typescript
async generateWithValidation(
  directive: string,
  worldState: WorldModel,
  maxRetries: number = 3
): Promise<Scene> {
  for (let attempt = 0; attempt < maxRetries; attempt++) {
    const scene = await llm.generate(buildPrompt(directive, worldState));

    const validation = await validateConsistency(scene, worldState);

    if (validation.isValid) {
      worldState = updateWorldState(scene);
      return scene;
    } else {
      // ã‚¨ãƒ©ãƒ¼ã‚’ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã—ã¦å†ç”Ÿæˆ
      directive = addCorrectionInstructions(directive, validation.errors);
    }
  }

  throw new Error('ä¸€è²«æ€§ã®ã‚ã‚‹ã‚·ãƒ¼ãƒ³ç”Ÿæˆã«å¤±æ•—');
}
```

### 4. ä¸€è²«æ€§æ¤œè¨¼ã‚·ã‚¹ãƒ†ãƒ 

```typescript
interface ConsistencyValidator {
  // ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ä¸€è²«æ€§
  validateCharacter(scene: Scene, character: StoryCharacter): ValidationResult;

  // ãƒ—ãƒ­ãƒƒãƒˆä¸€è²«æ€§ï¼ˆå› æœé–¢ä¿‚ï¼‰
  validatePlot(scene: Scene, events: PlotNode[]): ValidationResult;

  // ä¸–ç•Œãƒ«ãƒ¼ãƒ«ä¸€è²«æ€§
  validateWorldRules(scene: Scene, rules: WorldRule[]): ValidationResult;
}

interface ValidationResult {
  isValid: boolean;
  score: number;  // 0-1
  errors: ValidationError[];
}
```

---

## ğŸš¨ é‡è¦ãªæ³¨æ„äº‹é …ï¼ˆè³‡æ–™ã‚ˆã‚Šï¼‰

### ã‚„ã£ã¦ã¯ã„ã‘ãªã„ã“ã¨

1. **RAGã ã‘ã«é ¼ã‚‹**
   - âŒ ãƒ™ã‚¯ãƒˆãƒ«æ¤œç´¢ã®ã¿ã§ä¸€è²«æ€§ä¿è¨¼
   - âœ… æ§‹é€ åŒ–ã•ã‚ŒãŸçŠ¶æ…‹ç®¡ç† + RAGã‚’è£œåŠ©ã¨ã—ã¦ä½¿ç”¨

2. **é•·ã„ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã«è©°ã‚è¾¼ã‚€**
   - âŒ å…¨æ–‡ã‚’ä¸€ã¤ã®ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã«
   - âœ… éšå±¤çš„ç®¡ç†ï¼ˆå…¨ä½“ã®åœ°å›³ + ç¾åœ¨åœ°ã®è©³ç´°ï¼‰

3. **è©•ä¾¡ã‚’å¾Œå›ã—ã«ã™ã‚‹**
   - âŒ ã€Œã¨ã‚Šã‚ãˆãšå‹•ãã€ã ã‘
   - âœ… é–‹ç™ºåˆæœŸã‹ã‚‰ä¸€è²«æ€§ãƒã‚§ãƒƒã‚¯çµ„ã¿è¾¼ã¿

### å‹å®‰å…¨é–‹ç™ºãƒ«ãƒ¼ãƒ«ï¼ˆçµ¶å¯¾éµå®ˆï¼‰

```typescript
// âŒ çµ¶å¯¾ç¦æ­¢
const data: any = await fetch(...);
function process(input: any): any { ... }

// âœ… å¿…é ˆ
interface APIResponse {
  outline: StoryOutline;
  metadata: GenerationMetadata;
}
const data: APIResponse = await fetch(...);

function processScene(input: Scene): ValidationResult {
  // é©åˆ‡ãªå‹å®šç¾©
}
```

---

## ğŸ“ˆ å®Ÿè£…å„ªå…ˆé †ä½

### MVPï¼ˆMinimum Viable Productï¼‰- 2-3é€±é–“
1. Phase 1 - ã‚¦ã‚£ã‚¶ãƒ¼ãƒ‰ï¼ˆã‚¸ãƒ£ãƒ³ãƒ«ã€ã‚­ãƒ£ãƒ©ã€æ§‹é€ é¸æŠï¼‰
2. Phase 3 - åŸºæœ¬åŸ·ç­†ç”»é¢ï¼ˆã‚·ãƒ¼ãƒ³ç”Ÿæˆã€ç·¨é›†å¯èƒ½ãƒ†ã‚­ã‚¹ãƒˆã‚¨ãƒªã‚¢ï¼‰
3. Phase 2 - ç°¡æ˜“ã‚¢ã‚¦ãƒˆãƒ©ã‚¤ãƒ³ç”Ÿæˆï¼ˆ3å¹•è‡ªå‹•ç”Ÿæˆï¼‰
4. æ—¢å­˜è»¢ç”¨: CharacterFormã€ChatSidebarã€MessageInput

### Phase 2ï¼ˆæ‹¡å¼µæ©Ÿèƒ½ï¼‰- 3-4é€±é–“
5. ä¸€è²«æ€§ãƒã‚§ãƒƒã‚¯æ©Ÿèƒ½
6. ãƒˆãƒ©ãƒƒã‚«ãƒ¼çµ±åˆï¼ˆã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼çŠ¶æ…‹è¿½è·¡ï¼‰
7. åˆ†å²ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ 
8. è©³ç´°ãªã‚¸ãƒ£ãƒ³ãƒ«/ã‚¯ã‚¨ã‚¹ãƒˆè¨­å®š

### Phase 3ï¼ˆé«˜åº¦æ©Ÿèƒ½ï¼‰- 4-6é€±é–“
9. ãƒãƒ«ãƒã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
10. ãƒ—ãƒ­ãƒƒãƒˆã‚°ãƒ©ãƒ•ãƒ“ã‚¸ãƒ¥ã‚¢ãƒ©ã‚¤ã‚¼ãƒ¼ã‚·ãƒ§ãƒ³
11. ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ è©•ä¾¡æŒ‡æ¨™
12. è¤‡æ•°ã‚¨ãƒ³ãƒ‡ã‚£ãƒ³ã‚°ç”Ÿæˆ

---

## ğŸ”— å‚ç…§è³‡æ–™

### å¿…èª­ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
1. `.claude/ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ã‚¸ã‚§ãƒãƒ¬ãƒ¼ã‚¿ãƒ¼é•ã„.md` - ãƒãƒ£ãƒƒãƒˆãƒœãƒƒãƒˆã¨ã®é•ã„è©³ç´°
2. `.claude/é¸æŠ.md` - å‚ç…§ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã®é¸æŠã‚·ã‚¹ãƒ†ãƒ 
3. `ğŸ¯ AI Chat V3 å®Œå…¨é–‹ç™ºã‚¬ã‚¤ãƒ‰.md` - æ—¢å­˜ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆç†è§£

### æ—¢å­˜å®Ÿè£…å‚ç…§
- ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ç®¡ç†: `src/types/core/character.types.ts`
- ãƒˆãƒ©ãƒƒã‚«ãƒ¼: `src/services/tracker/tracker-manager.ts`
- ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆæ§‹ç¯‰: `src/services/prompt-builder.service.ts`
- è¨˜æ†¶ã‚·ã‚¹ãƒ†ãƒ : `src/services/memory/memory-card-generator.ts`

---

## ğŸ¯ æ¬¡ã‚»ãƒƒã‚·ãƒ§ãƒ³ã¸ã®æŒ‡ç¤º

### ä½œæˆã™ã¹ãè¨­è¨ˆå›³ï¼ˆè¤‡æ•°ãƒ•ã‚¡ã‚¤ãƒ«æ¨å¥¨ï¼‰

1. **å‹å®šç¾©è¨­è¨ˆæ›¸** (`STORY_TYPES_DESIGN.md`)
   - æ ¸å¿ƒå‹å®šç¾©ï¼ˆWorldModel, StoryCharacter, PlotNodeç­‰ï¼‰
   - ç”Ÿæˆé–¢é€£å‹ï¼ˆGenerationRequest, ValidationResultç­‰ï¼‰
   - UIå‹å®šç¾©ï¼ˆå…¨ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®Propså‹ï¼‰

2. **ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£è¨­è¨ˆæ›¸** (`STORY_ARCHITECTURE_DESIGN.md`)
   - ã‚µãƒ¼ãƒ“ã‚¹å±¤è¨­è¨ˆ
   - çŠ¶æ…‹ç®¡ç†ãƒ•ãƒ­ãƒ¼
   - APIçµ±åˆæˆ¦ç•¥

3. **UIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆè¨­è¨ˆæ›¸** (`STORY_UI_COMPONENTS_DESIGN.md`)
   - å„ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®è©³ç´°ä»•æ§˜
   - æ—¢å­˜ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‹ã‚‰ã®å¤‰æ›´ç‚¹
   - ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ã‚·ãƒ§ãƒ³ãƒ•ãƒ­ãƒ¼å›³

4. **ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼è¨­è¨ˆæ›¸** (`STORY_DATA_FLOW_DESIGN.md`)
   - ç”Ÿæˆãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³è©³ç´°
   - æ¤œè¨¼ãƒ«ãƒ¼ãƒ—è¨­è¨ˆ
   - ä¸–ç•ŒçŠ¶æ…‹æ›´æ–°ãƒ•ãƒ­ãƒ¼

5. **å®Ÿè£…ãƒ­ãƒ¼ãƒ‰ãƒãƒƒãƒ—** (`STORY_IMPLEMENTATION_ROADMAP.md`)
   - MVPæ©Ÿèƒ½è©³ç´°
   - ã‚¿ã‚¹ã‚¯åˆ†è§£
   - æŠ€è¡“çš„ä¾å­˜é–¢ä¿‚

### è¨­è¨ˆè¦ä»¶

- âœ… 1ãƒ•ã‚¡ã‚¤ãƒ«200è¡Œä»¥å†…ï¼ˆè¶…ãˆã‚‹å ´åˆã¯åˆ†å‰²ï¼‰
- âœ… `any`å‹ä½¿ç”¨ç¦æ­¢
- âœ… è¦–èªæ€§é‡è¦–ï¼ˆå›³è¡¨ãƒ»ã‚³ãƒ¼ãƒ‰ä¾‹ã‚’è±Šå¯Œã«ï¼‰
- âœ… æ—¢å­˜ã‚³ãƒ¼ãƒ‰ã¸ã®ãƒªãƒ³ã‚¯æ˜è¨˜
- âœ… TypeScript strict ãƒ¢ãƒ¼ãƒ‰æº–æ‹ 

---

## ğŸ“Š æˆåŠŸæŒ‡æ¨™

### æŠ€è¡“çš„æŒ‡æ¨™
- ä¸€è²«æ€§ã‚¹ã‚³ã‚¢: 0.9ä»¥ä¸Š
- å‹å®‰å…¨æ€§: 100%ï¼ˆanyå‹ã‚¼ãƒ­ï¼‰
- ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆè»¢ç”¨ç‡: 65%ä»¥ä¸Š

### UXæŒ‡æ¨™
- åˆå¿ƒè€…ã§ã‚‚10åˆ†ä»¥å†…ã«ã‚¹ãƒˆãƒ¼ãƒªãƒ¼é–‹å§‹å¯èƒ½
- ä¸Šç´šè€…å‘ã‘è©³ç´°è¨­å®šã‚‚æä¾›
- ãƒ¢ãƒã‚¤ãƒ«å¯¾å¿œï¼ˆiPhone 15 Pro Maxæœ€é©åŒ–ï¼‰

---

**ã“ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’åŸºã«ã€æ¬¡ã®ã‚»ãƒƒã‚·ãƒ§ãƒ³ã§è©³ç´°è¨­è¨ˆå›³ã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚**
