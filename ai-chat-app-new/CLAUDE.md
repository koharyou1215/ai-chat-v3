# Claude Code 開発設定

## 必須参照ドキュメント

### 🎯 AI Chat V3 完全開発ガイド
- **ファイルパス**: `🎯 AI Chat V3 完全開発ガイド.md`
- **ルール**: 
  - 開発作業開始時に必ずこのドキュメントを読み込む
  - 機能追加・修正後は該当セクションを更新する
  - アーキテクチャ変更時は関連する図表も更新する

## 開発フロー

1. 作業開始前: 完全開発ガイドを参照
2. 既存コードの理解: アーキテクチャと設計パターンを確認
3. 実装: ガイドに従った設計で実装
4. 完了後: ガイドドキュメントを最新状態に更新

## プロジェクト保護ルール（絶対遵守）

### 1. UI保護ルール
- **現在のUIアイコンを絶対変更しない**: 既存のアイコン、レイアウト、デザインを維持する
- **UI要素の削除禁止**: 現在実装されている機能のUI要素は削除しない  
- **既存インタラクション保護**: 現在の操作方法、ホバー効果、アニメーションを維持

### 2. 既存機能保護ルール  
- **既存機能への影響回避**: コードの変更は既存機能に影響を与えない範囲で実施
- **API互換性維持**: 既存のAPIインターフェース、データ構造を保持
- **状態管理の一貫性**: Zustandストア、コンテキストの既存構造を維持

### 3. 設定永続化の確実性
- **設定が勝手に変更されることを防ぐ**: モデル設定、プロンプト設定等の自動変更を禁止
- **永続化の検証**: 設定変更後は必ず永続化が正しく動作することを確認
- **デフォルト値の慎重な設定**: デフォルト値変更時は既存ユーザーへの影響を考慮

### 4. デプロイ前必須チェック
- **根本調査の実施**: 反復修正エラーを防ぐため、問題の根本原因を必ず特定
- **既存機能の動作確認**: すべての主要機能が正常動作することを確認
- **設定保存・読み込みテスト**: 設定の永続化が正しく機能することを確認
- **画像・動画アップロード確認**: ファイル選択→アップロード→プレビュー表示が正常動作することを確認
- **システムプロンプト永続化確認**: カスタムプロンプト設定→保存→ページリロード→設定維持を確認
- **UI/UX破綻チェック**: レイアウト、アニメーション、レスポンシブ対応を確認
- **モバイル最適化確認**: タッチ操作、画面サイズ、Safe Area対応を確認

## 開発サーバー運用ルール（重要）

### 5. 開発サーバー制約
- **ポート3000固定**: ユーザー環境では3000以外のポートでサーバー起動禁止
- **サーバー起動前確認**: 必ず既存プロセスの確認と停止を実施
- **デバッグツール制約**: ユーザー環境ではブラウザ開発者ツールが使用不可
- **サーバー再起動時間**: .nextキャッシュクリアによる再起動は相当な時間を要する
- **エラー時の対処**: サーバーエラー発生時は即座にプロセス停止し、キャッシュクリア後に再起動

### サーバー運用コマンド
```bash
# プロセス確認
netstat -ano | findstr :3000

# プロセス停止
powershell "Stop-Process -Id [PID] -Force"

# キャッシュクリア＆再起動
powershell "Remove-Item -Recurse -Force .next -ErrorAction SilentlyContinue"
npm run dev
```

## その他の設定

- TypeScript strict モード使用
- ESLint/Prettier による自動フォーマット
- Git コミット前の必須チェック項目